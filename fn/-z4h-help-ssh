print -Pr -- "$(<<\END
usage: %F{2}z4h%f %Bssh%b [%Ussh-options%u] [%Uuser@%u]%Uhostname%u

Connect to the remote host over SSH and start Zsh with local configs.
The remote host must have login shell compatible with the Bourne shell
(sh, bash, zsh, ash, dash, etc.) and internet connection. Nothing else
is required.

Here's what %F{2}z4h%f %Bssh%b does in more detail:

  1. Archives Zsh config files on the local host and sends them to the
     remote host.
  2. Extracts Zsh config files on the remote host and sets %BZDOTDIR%b
     to instruct Zsh to read them.
  3. Sources %U.zshrc%u, which immediately sources %Uz4h.zsh%u. The latter
     takes care of installing Zsh to %U~/.zsh-bin%u and replacing the
     current shell process if necessary.

The list of files copied to the remote host is defined with %F{2}zstyle%f.
Here's the default value:

  %F{2}zstyle%f %F{3}':z4h:ssh:*'%f files                                                \
    $ZDOTDIR/.zshrc             %F{3}'$ZDOTDIR/'%f overwrite=1,remove=1,persist=0 \
    $ZDOTDIR/.p10k.zsh          %F{3}'$ZDOTDIR/'%f overwrite=1,remove=1,persist=0 \
    $ZDOTDIR/.p10k-portable.zsh %F{3}'$ZDOTDIR/'%f overwrite=1,remove=1,persist=0

Each triplet defines a file on the local host, its desired location on the
remote host and flags. If both local and the remote files exist, %Boverwrite=1%b
causes the remote file to be overwritten. If local file doesn't exist but
the remote file does, %Bremove=1%b causes the remove file to be deleted.
All remote files marked with %Bpersist=0%b get deleted when SSH connection
terminates.

The last segment in the %F{2}zstyle%f context (the snippet above has %F{3}*%f in its
place) is the last argument of %F{2}z4h%f %Bssh%b. It allows you to copy different
files to different remote hosts.

When SSH connection is established, function %F{2}z4h-ssh-remote-setup%f is
invoked to initialize environment. You can override it. By default it sets
%BZ4H_SSH=1%b, which lets you perform conditional initialization in %U.zshrc%u.

Similarly, when SSH connection is terminated, %F{2}z4h-ssh-remote-teardown%f
is called.

The first login to a remote host may take some time. After that it's as
fast as normal %F{2}ssh%f.
END
)"
