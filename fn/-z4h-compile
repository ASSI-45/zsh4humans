[[ "$1".zwc -nt "$1" ]] && return
[[ -w "${1:h}"       ]] || return
local tmp="$1".tmp."${sysparams[pid]}".zwc
{
  # This zf_rm is to work around bugs in NTFS and/or WSL. The following code fails there:
  #
  #   touch a b
  #   chmod -w b
  #   zf_rm -f a b
  #
  # The last command produces this error:
  #
  #   zf_mv: a: permission denied
  zcompile -R -- "$tmp" "$1" && zf_rm -f -- "$1".zwc && zf_mv -f -- "$tmp" "$1".zwc
} always {
  (( $? )) && zf_rm -f -- "$tmp"
}
